import{j as f}from"./jsx-runtime-D_zvdyIk.js";import{R as m,r as d}from"./iframe-j35EKpAQ.js";import{R as T,r as H}from"./index-BuEuhmWt.js";import{c as B}from"./index-DqVAgsJl.js";import{_ as J,a as P,b as $,c as Q}from"./objectWithoutPropertiesLoose-AGTbIyKU.js";import"./preload-helper-PPVm8Dsz.js";import"./index-DnnyNCso.js";function D(s,o){s.prototype=Object.create(o.prototype),s.prototype.constructor=s,J(s,o)}function Y(s,o){return s.classList?!!o&&s.classList.contains(o):(" "+(s.className.baseVal||s.className)+" ").indexOf(" "+o+" ")!==-1}function Z(s,o){s.classList?s.classList.add(o):Y(s,o)||(typeof s.className=="string"?s.className=s.className+" "+o:s.setAttribute("class",(s.className&&s.className.baseVal||"")+" "+o))}function y(s,o){return s.replace(new RegExp("(^|\\s)"+o+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function K(s,o){s.classList?s.classList.remove(o):typeof s.className=="string"?s.className=y(s.className,o):s.setAttribute("class",y(s.className&&s.className.baseVal||"",o))}const L={disabled:!1},M=m.createContext(null);var V=function(o){return o.scrollTop},N="unmounted",E="exited",x="entering",b="entered",O="exiting",v=(function(s){D(o,s);function o(n,t){var e;e=s.call(this,n,t)||this;var r=t,i=r&&!r.isMounting?n.enter:n.appear,a;return e.appearStatus=null,n.in?i?(a=E,e.appearStatus=x):a=b:n.unmountOnExit||n.mountOnEnter?a=N:a=E,e.state={status:a},e.nextCallback=null,e}o.getDerivedStateFromProps=function(t,e){var r=t.in;return r&&e.status===N?{status:E}:null};var u=o.prototype;return u.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},u.componentDidUpdate=function(t){var e=null;if(t!==this.props){var r=this.state.status;this.props.in?r!==x&&r!==b&&(e=x):(r===x||r===b)&&(e=O)}this.updateStatus(!1,e)},u.componentWillUnmount=function(){this.cancelNextCallback()},u.getTimeouts=function(){var t=this.props.timeout,e,r,i;return e=r=i=t,t!=null&&typeof t!="number"&&(e=t.exit,r=t.enter,i=t.appear!==void 0?t.appear:r),{exit:e,enter:r,appear:i}},u.updateStatus=function(t,e){if(t===void 0&&(t=!1),e!==null)if(this.cancelNextCallback(),e===x){if(this.props.unmountOnExit||this.props.mountOnEnter){var r=this.props.nodeRef?this.props.nodeRef.current:T.findDOMNode(this);r&&V(r)}this.performEnter(t)}else this.performExit();else this.props.unmountOnExit&&this.state.status===E&&this.setState({status:N})},u.performEnter=function(t){var e=this,r=this.props.enter,i=this.context?this.context.isMounting:t,a=this.props.nodeRef?[i]:[T.findDOMNode(this),i],c=a[0],l=a[1],p=this.getTimeouts(),h=i?p.appear:p.enter;if(!t&&!r||L.disabled){this.safeSetState({status:b},function(){e.props.onEntered(c)});return}this.props.onEnter(c,l),this.safeSetState({status:x},function(){e.props.onEntering(c,l),e.onTransitionEnd(h,function(){e.safeSetState({status:b},function(){e.props.onEntered(c,l)})})})},u.performExit=function(){var t=this,e=this.props.exit,r=this.getTimeouts(),i=this.props.nodeRef?void 0:T.findDOMNode(this);if(!e||L.disabled){this.safeSetState({status:E},function(){t.props.onExited(i)});return}this.props.onExit(i),this.safeSetState({status:O},function(){t.props.onExiting(i),t.onTransitionEnd(r.exit,function(){t.safeSetState({status:E},function(){t.props.onExited(i)})})})},u.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},u.safeSetState=function(t,e){e=this.setNextCallback(e),this.setState(t,e)},u.setNextCallback=function(t){var e=this,r=!0;return this.nextCallback=function(i){r&&(r=!1,e.nextCallback=null,t(i))},this.nextCallback.cancel=function(){r=!1},this.nextCallback},u.onTransitionEnd=function(t,e){this.setNextCallback(e);var r=this.props.nodeRef?this.props.nodeRef.current:T.findDOMNode(this),i=t==null&&!this.props.addEndListener;if(!r||i){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var a=this.props.nodeRef?[this.nextCallback]:[r,this.nextCallback],c=a[0],l=a[1];this.props.addEndListener(c,l)}t!=null&&setTimeout(this.nextCallback,t)},u.render=function(){var t=this.state.status;if(t===N)return null;var e=this.props,r=e.children;e.in,e.mountOnEnter,e.unmountOnExit,e.appear,e.enter,e.exit,e.timeout,e.addEndListener,e.onEnter,e.onEntering,e.onEntered,e.onExit,e.onExiting,e.onExited,e.nodeRef;var i=P(e,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return m.createElement(M.Provider,{value:null},typeof r=="function"?r(t,i):m.cloneElement(m.Children.only(r),i))},o})(m.Component);v.contextType=M;v.propTypes={};function C(){}v.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:C,onEntering:C,onEntered:C,onExit:C,onExiting:C,onExited:C};v.UNMOUNTED=N;v.EXITED=E;v.ENTERING=x;v.ENTERED=b;v.EXITING=O;var ee=function(o,u){return o&&u&&u.split(" ").forEach(function(n){return Z(o,n)})},S=function(o,u){return o&&u&&u.split(" ").forEach(function(n){return K(o,n)})},_=(function(s){D(o,s);function o(){for(var n,t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return n=s.call.apply(s,[this].concat(e))||this,n.appliedClasses={appear:{},enter:{},exit:{}},n.onEnter=function(i,a){var c=n.resolveArguments(i,a),l=c[0],p=c[1];n.removeClasses(l,"exit"),n.addClass(l,p?"appear":"enter","base"),n.props.onEnter&&n.props.onEnter(i,a)},n.onEntering=function(i,a){var c=n.resolveArguments(i,a),l=c[0],p=c[1],h=p?"appear":"enter";n.addClass(l,h,"active"),n.props.onEntering&&n.props.onEntering(i,a)},n.onEntered=function(i,a){var c=n.resolveArguments(i,a),l=c[0],p=c[1],h=p?"appear":"enter";n.removeClasses(l,h),n.addClass(l,h,"done"),n.props.onEntered&&n.props.onEntered(i,a)},n.onExit=function(i){var a=n.resolveArguments(i),c=a[0];n.removeClasses(c,"appear"),n.removeClasses(c,"enter"),n.addClass(c,"exit","base"),n.props.onExit&&n.props.onExit(i)},n.onExiting=function(i){var a=n.resolveArguments(i),c=a[0];n.addClass(c,"exit","active"),n.props.onExiting&&n.props.onExiting(i)},n.onExited=function(i){var a=n.resolveArguments(i),c=a[0];n.removeClasses(c,"exit"),n.addClass(c,"exit","done"),n.props.onExited&&n.props.onExited(i)},n.resolveArguments=function(i,a){return n.props.nodeRef?[n.props.nodeRef.current,i]:[i,a]},n.getClassNames=function(i){var a=n.props.classNames,c=typeof a=="string",l=c&&a?a+"-":"",p=c?""+l+i:a[i],h=c?p+"-active":a[i+"Active"],z=c?p+"-done":a[i+"Done"];return{baseClassName:p,activeClassName:h,doneClassName:z}},n}var u=o.prototype;return u.addClass=function(t,e,r){var i=this.getClassNames(e)[r+"ClassName"],a=this.getClassNames("enter"),c=a.doneClassName;e==="appear"&&r==="done"&&c&&(i+=" "+c),r==="active"&&t&&V(t),i&&(this.appliedClasses[e][r]=i,ee(t,i))},u.removeClasses=function(t,e){var r=this.appliedClasses[e],i=r.base,a=r.active,c=r.done;this.appliedClasses[e]={},i&&S(t,i),a&&S(t,a),c&&S(t,c)},u.render=function(){var t=this.props;t.classNames;var e=P(t,["classNames"]);return m.createElement(v,$({},e,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},o})(m.Component);_.defaultProps={classNames:""};_.propTypes={};function j(s,o){var u=function(e){return o&&d.isValidElement(e)?o(e):e},n=Object.create(null);return s&&d.Children.map(s,function(t){return t}).forEach(function(t){n[t.key]=u(t)}),n}function te(s,o){s=s||{},o=o||{};function u(l){return l in o?o[l]:s[l]}var n=Object.create(null),t=[];for(var e in s)e in o?t.length&&(n[e]=t,t=[]):t.push(e);var r,i={};for(var a in o){if(n[a])for(r=0;r<n[a].length;r++){var c=n[a][r];i[n[a][r]]=u(c)}i[a]=u(a)}for(r=0;r<t.length;r++)i[t[r]]=u(t[r]);return i}function g(s,o,u){return u[o]!=null?u[o]:s.props[o]}function ne(s,o){return j(s.children,function(u){return d.cloneElement(u,{onExited:o.bind(null,u),in:!0,appear:g(u,"appear",s),enter:g(u,"enter",s),exit:g(u,"exit",s)})})}function re(s,o,u){var n=j(s.children),t=te(o,n);return Object.keys(t).forEach(function(e){var r=t[e];if(d.isValidElement(r)){var i=e in o,a=e in n,c=o[e],l=d.isValidElement(c)&&!c.props.in;a&&(!i||l)?t[e]=d.cloneElement(r,{onExited:u.bind(null,r),in:!0,exit:g(r,"exit",s),enter:g(r,"enter",s)}):!a&&i&&!l?t[e]=d.cloneElement(r,{in:!1}):a&&i&&d.isValidElement(c)&&(t[e]=d.cloneElement(r,{onExited:u.bind(null,r),in:c.props.in,exit:g(r,"exit",s),enter:g(r,"enter",s)}))}}),t}var se=Object.values||function(s){return Object.keys(s).map(function(o){return s[o]})},ie={component:"div",childFactory:function(o){return o}},k=(function(s){D(o,s);function o(n,t){var e;e=s.call(this,n,t)||this;var r=e.handleExited.bind(Q(e));return e.state={contextValue:{isMounting:!0},handleExited:r,firstRender:!0},e}var u=o.prototype;return u.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},u.componentWillUnmount=function(){this.mounted=!1},o.getDerivedStateFromProps=function(t,e){var r=e.children,i=e.handleExited,a=e.firstRender;return{children:a?ne(t,i):re(t,r,i),firstRender:!1}},u.handleExited=function(t,e){var r=j(this.props.children);t.key in r||(t.props.onExited&&t.props.onExited(e),this.mounted&&this.setState(function(i){var a=$({},i.children);return delete a[t.key],{children:a}}))},u.render=function(){var t=this.props,e=t.component,r=t.childFactory,i=P(t,["component","childFactory"]),a=this.state.contextValue,c=se(this.state.children).map(r);return delete i.appear,delete i.enter,delete i.exit,e===null?m.createElement(M.Provider,{value:a},c):m.createElement(M.Provider,{value:a},m.createElement(e,i,c))},o})(m.Component);k.propTypes={};k.defaultProps=ie;const I={top:[],bottom:[]},oe=s=>{const[o,u]=d.useState(I);return{messageList:o,add:n=>{const t=ae(n);return u(e=>{if(n?.id&&U(e,n?.id))return e;const r=n.position||s,i=r.includes("top")?[{...n,id:t,nodeRef:d.createRef()},...e[r]]:[...e[r],{...n,id:t,nodeRef:d.createRef()}];return{...e,[r]:i}}),t},update:(n,t)=>{n&&u(e=>{const{position:r,index:i}=w(e,n);if(!r)return e;const a={...e};return i!==-1&&r&&(a[r][i]={...a[r][i],...t}),a})},remove:n=>{n&&u(t=>{const{index:e,position:r}=w(t,n);if(!r)return t;const i={...t};return e!==-1&&r&&(i[r]=i[r].filter(a=>a.id!==n)),i})},clearAll:()=>{u(I)}}};let A=0;function ae(s){return s.id?s.id:(A++,A)}function U(s,o){for(const[u,n]of Object.entries(s))if(n.find(t=>t.id===o))return u}function w(s,o){const u=U(s,o),n=u?s[u].findIndex(t=>t.id===o):-1;return{position:u,index:n}}function ue(s){const{id:o,duration:u=1e3,remove:n}=s,t=d.useRef(null),e=()=>{t.current&&(clearTimeout(t.current),t.current=null)},r=()=>{t.current=setTimeout(()=>{n(o),e()},u)};return d.useEffect(()=>(r(),()=>e()),[]),{onMouseEnter:()=>{e()},onMouseLeave:()=>{t.current&&(clearTimeout(t.current),t.current=null),r()}}}const F=d.forwardRef((s,o)=>{const{className:u,style:n,content:t}=s,{onMouseEnter:e,onMouseLeave:r}=ue(s);return f.jsx("div",{ref:o,className:B(u,"message-item"),style:n,onMouseEnter:e,onMouseLeave:r,children:t})});F.__docgenInfo={description:"",methods:[],displayName:"MessageItem",props:{duration:{required:!1,tsType:{name:"number"},description:""},id:{required:!1,tsType:{name:"number"},description:""},remove:{required:!0,tsType:{name:"signature",type:"function",raw:"(id: number) => void",signature:{arguments:[{type:{name:"number"},name:"id"}],return:{name:"void"}}},description:""},className:{required:!1,tsType:{name:"string"},description:""},style:{required:!1,tsType:{name:"CSSProperties"},description:""},content:{required:!1,tsType:{name:"ReactNode"},description:""}}};const G=d.forwardRef((s,o)=>{const{messageList:u,add:n,remove:t,update:e,clearAll:r}=oe("top");"current"in o&&(o.current={messageList:u,add:n,remove:t,update:e,clearAll:r});const i=Object.keys(u),a=f.jsx("div",{className:"message-wrapper",children:i.map(l=>f.jsx(k,{className:`message-wrapper-${l}`,children:u[l].map(p=>f.jsx(_,{nodeRef:p.nodeRef,classNames:"message",timeout:1e3,children:f.jsx(F,{ref:p.nodeRef,...p,remove:t})},p.id))},l))}),c=d.useMemo(()=>{const l=document.createElement("div");return l.className="message-container",document.body.appendChild(l),l},[]);return H.createPortal(a,c)});G.__docgenInfo={description:"",methods:[],displayName:"MessageProvider"};const q=d.createContext({});function W(s){const{children:o}=s,u=d.useRef(null);return f.jsxs(q.Provider,{value:{messageProviderRef:u},children:[f.jsx(G,{ref:u}),o]})}W.__docgenInfo={description:"",methods:[],displayName:"ConfigProvider"};function ce(){const{messageProviderRef:s}=d.useContext(q);if(!s)throw new Error("请在最外层添加 ConfigProvider 组件");return s.current}function X(){const s=ce();return f.jsxs("div",{children:[f.jsx("button",{onClick:()=>s.add({content:"顶部消息",position:"top"}),children:"显示顶部消息"}),f.jsx("button",{onClick:()=>s.add({content:"显示底部消息",position:"bottom"}),children:"显示底部消息"}),f.jsx("button",{onClick:()=>{s.add({content:"消息id===111",position:"top",id:1111})},children:"显示消息id=1111"}),f.jsx("button",{onClick:()=>s.remove(1111),children:"删除消息id=1111"}),f.jsx("button",{onClick:()=>s.update(1111,{content:"你好"}),children:"更新消息id=1111为你好"})]})}X.__docgenInfo={description:"",methods:[],displayName:"MessageDemo"};const Ee={title:"Components/Message",component:X,decorators:[s=>f.jsx(W,{children:f.jsx(s,{})})],parameters:{layout:"center",docs:{description:{component:"消息提示组件的完整使用文档"}}}},R={args:{},parameters:{docs:{source:{code:`
        function MessageDemo() {
  const messageProviderRef = useMessage();
  return (
    <div>
      <button
        onClick={() =>
          messageProviderRef.add({ content: "顶部消息", position: "top" })
        }
      >
        显示顶部消息
      </button>
      <button
        onClick={() =>
          messageProviderRef.add({
            content: "显示底部消息",
            position: "bottom",
          })
        }
      >
        显示底部消息
      </button>
    </div>
  );
}
        `}}}};R.parameters={...R.parameters,docs:{...R.parameters?.docs,source:{originalSource:`{
  args: {},
  parameters: {
    docs: {
      source: {
        code: \`
        function MessageDemo() {
  const messageProviderRef = useMessage();
  return (
    <div>
      <button
        onClick={() =>
          messageProviderRef.add({ content: "顶部消息", position: "top" })
        }
      >
        显示顶部消息
      </button>
      <button
        onClick={() =>
          messageProviderRef.add({
            content: "显示底部消息",
            position: "bottom",
          })
        }
      >
        显示底部消息
      </button>
    </div>
  );
}
        \`
      }
    }
  }
}`,...R.parameters?.docs?.source}}};const xe=["Default"];export{R as Default,xe as __namedExportsOrder,Ee as default};
